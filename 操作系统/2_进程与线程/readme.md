# 进程与线程

## 1.进程与线程

### 进程通信

![进程通信](./img/进程通信.png "进程通信")

### 线程和多线程模型

![线程和多线程模型](./img/线程和多线程模型.png "线程和多线程模型")

## 2.调度

### 调度的层次

![调度的层次](./img/调度的层次.png "调度的层次")

- 作业调度：给后背队列的作业分配内存等必要资源，建立相应进程，是面向作业的主存与辅存的调度。
- 内存调度：讲暂时不能允许的进程挂起（调至外存），或在内存有空闲时把已具备运行条件的进程重新载入内存。是面向进程的主存与辅存的调度。
- 进程调度：从就绪队列选择一个进程，把处理机分配给它，是CPU调度。
- 作业：一个具体的任务。

![进程七态模型](./img/进程七态模型.png "进程七态模型")
![调度的基本概念](./img/调度的基本概念.png "调度的基本概念")

### 调度的时机、切换与过程

- 调度的时机：进程（主动或被动）放弃处理机时，需要用进程调度算法选择下一个占有处理机的进程。
    > 主动放弃处理机：进程正常终止、进程异常终止、进程阻塞  
    > 被动放弃处理机：分给进程的时间片用完、有更紧急的事要处理(比如中断)、有更高优先级的进程进入就绪队列
- 不能进行调度的情况：处理中断过程中、程序在操作系统内核程序临界区中、原语执行过程中
    > 注意：内核程序临界区不等于临界区。内核程序临界区一般是访问某种*内核数据结构*，比如进程就绪队列；临界区是指访问临界资源的那段代码。

补充说明

- 广义的进程调度包含进程选择和进程切换
- 进程选择：从就绪队列中选择一个要运行的进程。
- 进程切换：对原来进程的各种数据的保存，对新进程的各种数据的恢复。
- 进程切换是有代价的，过于频繁的进程调度会使整个系统的效率降低。

抢占式与非抢占式

- 抢占式：可由操作系统剥夺当前进程的CPU使用权
- 非抢占式：操作系统不能剥夺当前进程的CPU使用权

![进程调度时机、切换、过程](./img/进程调度时机、切换、过程.png "进程调度时机、切换、过程")

### 调度器和闲逛进程

调度器

- 调度器(scheduler)，又称调度程序，就绪态和运行态的转换由低调度程序决定。
- 调度算法决定谁来运行，时间片大小决定运行时长。
- 创建进程、进程退出、进程阻塞和IO中断时，会触发调度程序。
- 调度程序调度的对象是进程或内核级线程。（若内核级线程是调度的基本单位，则进程是资源分配的基本单位）。

闲逛进程

- 优先级最低、可以是零地址指令、占1个时钟周期、能耗低
